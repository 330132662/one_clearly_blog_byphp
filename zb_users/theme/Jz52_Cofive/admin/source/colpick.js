(function(c){var f=function(){var f='<div class="colpick"><div class="colpick_color"><div class="colpick_color_overlay1"><div class="colpick_color_overlay2"><div class="colpick_selector_outer"><div class="colpick_selector_inner"></div></div></div></div></div><div class="colpick_hue"><div class="colpick_hue_arrs"><div class="colpick_hue_larr"></div><div class="colpick_hue_rarr"></div></div></div><div class="colpick_new_color"></div><div class="colpick_current_color"></div><div class="colpick_hex_field"><div class="colpick_field_letter">#</div><input type="text" maxlength="6" size="6" /></div><div class="colpick_rgb_r colpick_field"><div class="colpick_field_letter">R</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_rgb_g colpick_field"><div class="colpick_field_letter">G</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_rgb_b colpick_field"><div class="colpick_field_letter">B</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_hsb_h colpick_field"><div class="colpick_field_letter">H</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_hsb_s colpick_field"><div class="colpick_field_letter">S</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_hsb_b colpick_field"><div class="colpick_field_letter">B</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_submit"></div></div>',d={showEvent:"click",onShow:function(){},onBeforeShow:function(){},onHide:function(){},onChange:function(){},onSubmit:function(){},colorScheme:"light",color:"3289c7",livePreview:true,flat:false,layout:"full",submit:1,submitText:"OK",height:156},ce=function(f,d){var Q=I(f);c(d).data("colpick").fields.eq(1).val(Q.r).end().eq(2).val(Q.g).end().eq(3).val(Q.b).end()},g=function(f,d){c(d).data("colpick").fields.eq(4).val(Math.round(f.h)).end().eq(5).val(Math.round(f.s)).end().eq(6).val(Math.round(f.b)).end()},C=function(f,d){c(d).data("colpick").fields.eq(0).val(dD(f))},dF=function(f,d){c(d).data("colpick").selector.css("backgroundColor","#"+dD({h:f.h,s:100,b:100}));c(d).data("colpick").selectorIndic.css({left:parseInt(c(d).data("colpick").height*f.s/100,10),top:parseInt(c(d).data("colpick").height*(100-f.b)/100,10)})},fB=function(f,d){c(d).data("colpick").hue.css("top",parseInt(c(d).data("colpick").height-c(d).data("colpick").height*f.h/360,10))},h=function(f,d){c(d).data("colpick").currentColor.css("backgroundColor","#"+dD(f))},df=function(f,d){c(d).data("colpick").newColor.css("backgroundColor","#"+dD(f))},L=function(f){var d=c(this).parent().parent(),h;if(this.parentNode.className.indexOf("_hex")>0){d.data("colpick").color=h=Q(aC(this.value));ce(h,d.get(0));g(h,d.get(0))}else if(this.parentNode.className.indexOf("_hsb")>0){d.data("colpick").color=h=bf({h:parseInt(d.data("colpick").fields.eq(4).val(),10),s:parseInt(d.data("colpick").fields.eq(5).val(),10),b:parseInt(d.data("colpick").fields.eq(6).val(),10)});ce(h,d.get(0));C(h,d.get(0))}else{d.data("colpick").color=h=b(cN({r:parseInt(d.data("colpick").fields.eq(1).val(),10),g:parseInt(d.data("colpick").fields.eq(2).val(),10),b:parseInt(d.data("colpick").fields.eq(3).val(),10)}));C(h,d.get(0));g(h,d.get(0))}dF(h,d.get(0));fB(h,d.get(0));df(h,d.get(0));d.data("colpick").onChange.apply(d.parent(),[h,dD(h),I(h),d.data("colpick").el,0])},a=function(f){c(this).parent().removeClass("colpick_focus")},ge=function(){c(this).parent().parent().data("colpick").fields.parent().removeClass("colpick_focus");c(this).parent().addClass("colpick_focus")},G=function(f){f.preventDefault?f.preventDefault():f.returnValue=false;var d=c(this).parent().find("input").focus();var Q={el:c(this).parent().addClass("colpick_slider"),max:this.parentNode.className.indexOf("_hsb_h")>0?360:this.parentNode.className.indexOf("_hsb")>0?100:255,y:f.pageY,field:d,val:parseInt(d.val(),10),preview:c(this).parent().parent().data("colpick").livePreview};c(document).mouseup(Q,cH);c(document).mousemove(Q,bP)},bP=function(c){c.data.field.val(Math.max(0,Math.min(c.data.max,parseInt(c.data.val-c.pageY+c.data.y,10))));if(c.data.preview){L.apply(c.data.field.get(0),[true])}return false},cH=function(f){L.apply(f.data.field.get(0),[true]);f.data.el.removeClass("colpick_slider").find("input").focus();c(document).off("mouseup",cH);c(document).off("mousemove",bP);return false},ae=function(f){f.preventDefault?f.preventDefault():f.returnValue=false;var d={cal:c(this).parent(),y:c(this).offset().top};c(document).on("mouseup touchend",d,F);c(document).on("mousemove touchmove",d,e);var Q=f.type=="touchstart"?f.originalEvent.changedTouches[0].pageY:f.pageY;L.apply(d.cal.data("colpick").fields.eq(4).val(parseInt(360*(d.cal.data("colpick").height-(Q-d.y))/d.cal.data("colpick").height,10)).get(0),[d.cal.data("colpick").livePreview]);return false},e=function(c){var f=c.type=="touchmove"?c.originalEvent.changedTouches[0].pageY:c.pageY;L.apply(c.data.cal.data("colpick").fields.eq(4).val(parseInt(360*(c.data.cal.data("colpick").height-Math.max(0,Math.min(c.data.cal.data("colpick").height,f-c.data.y)))/c.data.cal.data("colpick").height,10)).get(0),[c.data.preview]);return false},F=function(f){ce(f.data.cal.data("colpick").color,f.data.cal.get(0));C(f.data.cal.data("colpick").color,f.data.cal.get(0));c(document).off("mouseup touchend",F);c(document).off("mousemove touchmove",e);return false},gJ=function(f){f.preventDefault?f.preventDefault():f.returnValue=false;var d={cal:c(this).parent(),pos:c(this).offset()};d.preview=d.cal.data("colpick").livePreview;c(document).on("mouseup touchend",d,aL);c(document).on("mousemove touchmove",d,bQ);var Q,b;if(f.type=="touchstart"){pageX=f.originalEvent.changedTouches[0].pageX,b=f.originalEvent.changedTouches[0].pageY}else{pageX=f.pageX;b=f.pageY}L.apply(d.cal.data("colpick").fields.eq(6).val(parseInt(100*(d.cal.data("colpick").height-(b-d.pos.top))/d.cal.data("colpick").height,10)).end().eq(5).val(parseInt(100*(pageX-d.pos.left)/d.cal.data("colpick").height,10)).get(0),[d.preview]);return false},bQ=function(c){var f,d;if(c.type=="touchmove"){pageX=c.originalEvent.changedTouches[0].pageX,d=c.originalEvent.changedTouches[0].pageY}else{pageX=c.pageX;d=c.pageY}L.apply(c.data.cal.data("colpick").fields.eq(6).val(parseInt(100*(c.data.cal.data("colpick").height-Math.max(0,Math.min(c.data.cal.data("colpick").height,d-c.data.pos.top)))/c.data.cal.data("colpick").height,10)).end().eq(5).val(parseInt(100*Math.max(0,Math.min(c.data.cal.data("colpick").height,pageX-c.data.pos.left))/c.data.cal.data("colpick").height,10)).get(0),[c.data.preview]);return false},aL=function(f){ce(f.data.cal.data("colpick").color,f.data.cal.get(0));C(f.data.cal.data("colpick").color,f.data.cal.get(0));c(document).off("mouseup touchend",aL);c(document).off("mousemove touchmove",bQ);return false},ai=function(f){var d=c(this).parent();var Q=d.data("colpick").color;d.data("colpick").origColor=Q;h(Q,d.get(0));d.data("colpick").onSubmit(Q,dD(Q),I(Q),d.data("colpick").el)},cj=function(f){f.stopPropagation();var d=c("#"+c(this).data("colpickId"));d.data("colpick").onBeforeShow.apply(this,[d.get(0)]);var Q=c(this).offset();var b=Q.top+this.offsetHeight;var I=Q.left;var ce=bA();var dD=d.width();if(I+dD>ce.l+ce.w){I-=dD}d.css({left:I+"px",top:b+"px"});if(d.data("colpick").onShow.apply(this,[d.get(0)])!=false){d.show()}c("html").mousedown({cal:d},gd);d.mousedown(function(c){c.stopPropagation()})},gd=function(f){if(f.data.cal.data("colpick").onHide.apply(this,[f.data.cal.get(0)])!=false){f.data.cal.hide()}c("html").off("mousedown",gd)},bA=function(){var c=document.compatMode=="CSS1Compat";return{l:window.pageXOffset||(c?document.documentElement.scrollLeft:document.body.scrollLeft),w:window.innerWidth||(c?document.documentElement.clientWidth:document.body.clientWidth)}},bf=function(c){return{h:Math.min(360,Math.max(0,c.h)),s:Math.min(100,Math.max(0,c.s)),b:Math.min(100,Math.max(0,c.b))}},cN=function(c){return{r:Math.min(255,Math.max(0,c.r)),g:Math.min(255,Math.max(0,c.g)),b:Math.min(255,Math.max(0,c.b))}},aC=function(c){var f=6-c.length;if(f>0){var d=[];for(var Q=0;Q<f;Q++){d.push("0")}d.push(c);c=d.join("")}return c},fL=function(){var f=c(this).parent();var d=f.data("colpick").origColor;f.data("colpick").color=d;ce(d,f.get(0));C(d,f.get(0));g(d,f.get(0));dF(d,f.get(0));fB(d,f.get(0));df(d,f.get(0))};return{init:function(I){I=c.extend({},d,I||{});if(typeof I.color=="string"){I.color=Q(I.color)}else if(I.color.r!=undefined&&I.color.g!=undefined&&I.color.b!=undefined){I.color=b(I.color)}else if(I.color.h!=undefined&&I.color.s!=undefined&&I.color.b!=undefined){I.color=bf(I.color)}else{return this}return this.each(function(){if(!c(this).data("colpickId")){var d=c.extend({},I);d.origColor=I.color;var Q="collorpicker_"+parseInt(Math.random()*1e3);c(this).data("colpickId",Q);var b=c(f).attr("id",Q);b.addClass("colpick_"+d.layout+(d.submit?"":" colpick_"+d.layout+"_ns"));if(d.colorScheme!="light"){b.addClass("colpick_"+d.colorScheme)}b.find("div.colpick_submit").html(d.submitText).click(ai);d.fields=b.find("input").change(L).blur(a).focus(ge);b.find("div.colpick_field_arrs").mousedown(G).end().find("div.colpick_current_color").click(fL);d.selector=b.find("div.colpick_color").on("mousedown touchstart",gJ);d.selectorIndic=d.selector.find("div.colpick_selector_outer");d.el=this;d.hue=b.find("div.colpick_hue_arrs");huebar=d.hue.parent();var dD=navigator.userAgent.toLowerCase();var bP=navigator.appName==="Microsoft Internet Explorer";var cH=bP?parseFloat(dD.match(/msie ([0-9]{1,}[\.0-9]{0,})/)[1]):0;var e=bP&&cH<10;var F=["#ff0000","#ff0080","#ff00ff","#8000ff","#0000ff","#0080ff","#00ffff","#00ff80","#00ff00","#80ff00","#ffff00","#ff8000","#ff0000"];if(e){var bQ,aL;for(bQ=0;bQ<=11;bQ++){aL=c("<div></div>").attr("style","height:8.333333%; filter:progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr="+F[bQ]+", endColorstr="+F[bQ+1]+'); -ms-filter: "progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr='+F[bQ]+", endColorstr="+F[bQ+1]+')";');huebar.append(aL)}}else{stopList=F.join(",");huebar.attr("style","background:-webkit-linear-gradient(top,"+stopList+"); background: -o-linear-gradient(top,"+stopList+"); background: -ms-linear-gradient(top,"+stopList+"); background:-moz-linear-gradient(top,"+stopList+"); -webkit-linear-gradient(top,"+stopList+"); background:linear-gradient(to bottom,"+stopList+"); ")}b.find("div.colpick_hue").on("mousedown touchstart",ae);d.newColor=b.find("div.colpick_new_color");d.currentColor=b.find("div.colpick_current_color");b.data("colpick",d);ce(d.color,b.get(0));g(d.color,b.get(0));C(d.color,b.get(0));fB(d.color,b.get(0));dF(d.color,b.get(0));h(d.color,b.get(0));df(d.color,b.get(0));if(d.flat){b.appendTo(this).show();b.css({position:"relative",display:"block"})}else{b.appendTo(document.body);c(this).on(d.showEvent,cj);b.css({position:"absolute"})}}})},showPicker:function(){return this.each(function(){if(c(this).data("colpickId")){cj.apply(this)}})},hidePicker:function(){return this.each(function(){if(c(this).data("colpickId")){c("#"+c(this).data("colpickId")).hide()}})},setColor:function(f,d){d=typeof d==="undefined"?1:d;if(typeof f=="string"){f=Q(f)}else if(f.r!=undefined&&f.g!=undefined&&f.b!=undefined){f=b(f)}else if(f.h!=undefined&&f.s!=undefined&&f.b!=undefined){f=bf(f)}else{return this}return this.each(function(){if(c(this).data("colpickId")){var Q=c("#"+c(this).data("colpickId"));Q.data("colpick").color=f;Q.data("colpick").origColor=f;ce(f,Q.get(0));g(f,Q.get(0));C(f,Q.get(0));fB(f,Q.get(0));dF(f,Q.get(0));df(f,Q.get(0));Q.data("colpick").onChange.apply(Q.parent(),[f,dD(f),I(f),Q.data("colpick").el,1]);if(d){h(f,Q.get(0))}}})}}}();var d=function(c){var c=parseInt(c.indexOf("#")>-1?c.substring(1):c,16);return{r:c>>16,g:(c&65280)>>8,b:c&255}};var Q=function(c){return b(d(c))};var b=function(c){var f={h:0,s:0,b:0};var d=Math.min(c.r,c.g,c.b);var Q=Math.max(c.r,c.g,c.b);var b=Q-d;f.b=Q;f.s=Q!=0?255*b/Q:0;if(f.s!=0){if(c.r==Q)f.h=(c.g-c.b)/b;else if(c.g==Q)f.h=2+(c.b-c.r)/b;else f.h=4+(c.r-c.g)/b}else f.h=-1;f.h*=60;if(f.h<0)f.h+=360;f.s*=100/255;f.b*=100/255;return f};var I=function(c){var f={};var d=c.h;var Q=c.s*255/100;var b=c.b*255/100;if(Q==0){f.r=f.g=f.b=b}else{var I=b;var ce=(255-Q)*b/255;var dD=(I-ce)*(d%60)/60;if(d==360)d=0;if(d<60){f.r=I;f.b=ce;f.g=ce+dD}else if(d<120){f.g=I;f.b=ce;f.r=I-dD}else if(d<180){f.g=I;f.r=ce;f.b=ce+dD}else if(d<240){f.b=I;f.r=ce;f.g=I-dD}else if(d<300){f.b=I;f.g=ce;f.r=ce+dD}else if(d<360){f.r=I;f.g=ce;f.b=I-dD}else{f.r=0;f.g=0;f.b=0}}return{r:Math.round(f.r),g:Math.round(f.g),b:Math.round(f.b)}};var ce=function(f){var d=[f.r.toString(16),f.g.toString(16),f.b.toString(16)];c.each(d,function(c,f){if(f.length==1){d[c]="0"+f}});return d.join("")};var dD=function(c){return ce(I(c))};c.fn.extend({colpick:f.init,colpickHide:f.hidePicker,colpickShow:f.showPicker,colpickSetColor:f.setColor});c.extend({colpick:{rgbToHex:ce,rgbToHsb:b,hsbToHex:dD,hsbToRgb:I,hexToHsb:Q,hexToRgb:d}})})(jQuery);